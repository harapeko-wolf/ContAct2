# 2. 基本設計書

## 2.1. システムアーキテクチャ
### 2.1.1. フロントエンド
- フレームワーク: Next.js
- 状態管理: React Context + SWR
- UIライブラリ: Tailwind CSS
- テスト: Jest + React Testing Library
- ビルドツール: Vite

### 2.1.2. バックエンド
- フレームワーク: Laravel
- API: RESTful API
- 認証: Laravel Sanctum
- テスト: PHPUnit
- ジョブキュー: Redis

### 2.1.3. データベース
- メインDB: MySQL 8.4
- キャッシュ: Redis
- バックアップ: AWS S3

### 2.1.4. インフラストラクチャ
- コンテナ: Docker
- リバースプロキシ: Nginx
- ファイルストレージ: AWS S3
- メール配信: SendGrid
- エラー監視: Sentry

## 2.2. データベース設計
### 2.2.1. 主要テーブル
- users: 営業担当者情報
- companies: 会社情報
- documents: PDF資料情報
- document_shared_links: 共有リンク情報
- document_views: 閲覧ログ
- document_surveys: アンケート情報
- document_survey_responses: アンケート回答
- timerex_bookings: 予約情報

### 2.2.2. インデックス設計
- 検索頻度の高いカラムにインデックスを設定
- 複合インデックスの活用
- パフォーマンスを考慮したインデックス設計

## 2.3. API設計
### 2.3.1. 認証API
- ログイン/ログアウト
- トークンリフレッシュ
- パスワードリセット

### 2.3.2. 資料管理API
- CRUD操作
- アップロード/ダウンロード
- 共有リンク生成

### 2.3.3. 閲覧トラッキングAPI
- 閲覧ログ記録
- 統計情報取得

### 2.3.4. アンケートAPI
- アンケート設定
- 回答記録
- 結果集計

### 2.3.5. TimeRex連携API
- Webhook受信
- 予約情報管理

## 2.4. セキュリティ設計
### 2.4.1. 認証・認可
- JWTトークンによる認証
- ロールベースのアクセス制御
- CSRF対策

### 2.4.2. データ保護
- 暗号化通信（HTTPS）
- パスワードハッシュ化
- 機密情報の環境変数管理

### 2.4.3. ファイルセキュリティ
- 署名付きURL
- アクセス制御
- ウイルススキャン

## 2.5. パフォーマンス設計
### 2.5.1. キャッシュ戦略
- Redisによるキャッシュ
- ブラウザキャッシュ
- CDNの活用

### 2.5.2. データベース最適化
- インデックス設計
- クエリ最適化
- コネクションプール

### 2.5.3. 非同期処理
- ジョブキュー
- バッチ処理
- イベント駆動

## 2.6. 監視・運用設計
### 2.6.1. ログ管理
- アプリケーションログ
- アクセスログ
- エラーログ

### 2.6.2. 監視
- サーバー監視
- アプリケーション監視
- エラー監視

### 2.6.3. バックアップ
- データベースバックアップ
- ファイルバックアップ
- 設定バックアップ

## 2.7. スケーラビリティ設計
### 2.7.1. 水平スケーリング
- コンテナの水平スケーリング
- ロードバランシング
- セッション管理

### 2.7.2. 垂直スケーリング
- リソース拡張
- パフォーマンスチューニング
- キャッシュ最適化

## 2.8. 開発環境設計
### 2.8.1. ローカル環境
- Docker Compose
- 開発用データベース
- モックサービス

### 2.8.2. CI/CD
- GitHub Actions
- 自動テスト
- 自動デプロイ

### 2.8.3. 品質管理
- コードレビュー
- 静的解析
- テスト自動化 