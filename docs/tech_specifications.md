# ContAct2 技術仕様書

## 概要
ContAct2プロジェクトで使用している技術スタックの詳細仕様書です。

## フロントエンド技術スタック

### Next.js 15
- **バージョン**: 15.x (最新安定版)
- **リリース時期**: 2024年後期
- **主要な機能・変更点**:
  - App Routerの完全安定化
  - React 19との完全互換性
  - パフォーマンス向上（Server Components最適化）
  - TypeScriptサポートの強化
  - 新しい静的生成・SSR機能

### React
- **バージョン**: 19.x（Next.js 15に対応）
- **新機能**: 
  - Server Components の安定化
  - Suspenseの改良
  - Concurrent Features

### TypeScript
- **バージョン**: 5.x系（最新）
- **設定**: 厳格モード有効化
- **特徴**: 完全型安全設計

### その他フロントエンド技術
- **UIライブラリ**: Tailwind CSS
- **状態管理**: React Context + SWR
- **テストフレームワーク**: Jest + React Testing Library
- **ビルドツール**: Vite（Next.js統合）

## バックエンド技術スタック

### Laravel 12
- **バージョン**: 12.x（最新LTS対応版）
- **PHPバージョン**: 8.3以上推奨
- **リリース時期**: 2024年後期
- **主要な機能・変更点**:
  - パフォーマンス大幅向上
  - 新しいORM機能
  - API機能の強化
  - セキュリティ機能の向上
  - 開発者体験の改善

### PHP
- **バージョン**: 8.3系
- **設定**: strict_types有効化
- **コーディング規約**: PSR-12準拠

### 認証・セキュリティ
- **認証システム**: Laravel Sanctum
- **API認証**: SPA方式（セッションベース）
- **CSRF保護**: 有効化
- **CORS設定**: フロントエンド専用設定

### その他バックエンド技術
- **API設計**: RESTful API
- **テストフレームワーク**: PHPUnit
- **ジョブキュー**: Redis（将来実装予定）

## データベース

### MySQL
- **バージョン**: 8.4 LTS
- **特徴**: 
  - 高いパフォーマンス
  - JSON型サポート
  - UUID主キー対応
  - インデックス最適化

### データベース設計方針
- **主キー**: UUID使用
- **命名規則**: スネークケース
- **インデックス**: パフォーマンス重視設計
- **リレーション**: 外部キー制約有効

## インフラストラクチャ

### 開発環境
- **コンテナ**: Docker + Docker Compose
- **リバースプロキシ**: Nginx
- **開発DB**: MySQL 8.4
- **管理ツール**: phpMyAdmin

### 本番環境（推奨）
- **クラウド**: AWS
- **コンピューティング**: ECS Fargate
- **データベース**: RDS MySQL
- **ストレージ**: S3
- **CDN**: CloudFront
- **DNS**: Route 53

## 外部サービス連携

### TimeRex連携
- **API方式**: Webhook
- **認証**: カスタムトークン認証
- **イベント**: 予約確定・キャンセル
- **データ保存**: companiesテーブルJSON列

### メール配信（将来実装）
- **推奨サービス**: SendGrid / Amazon SES
- **用途**: フォローアップメール自動送信

### 監視・エラー追跡（将来実装）
- **エラー監視**: Sentry
- **パフォーマンス監視**: New Relic / DataDog

## セキュリティ仕様

### データ保護
- **通信**: HTTPS強制
- **認証**: セッションベース + CSRF保護
- **ファイルアクセス**: 署名付きURL（将来実装）
- **環境変数**: .env による機密情報管理

### アクセス制御
- **管理者権限**: admin フラグによる制御
- **API認証**: Laravel Sanctum
- **公開API**: 認証不要（閲覧・フィードバック）
- **管理API**: 認証必須

## パフォーマンス仕様

### 目標パフォーマンス
- **PDF表示**: 初回3秒以内
- **API応答**: 500ms以内
- **ページロード**: 2秒以内
- **同時接続**: 100ユーザー対応

### 最適化戦略
- **フロントエンド**: Server Components活用
- **バックエンド**: クエリ最適化・インデックス活用
- **キャッシュ**: Redis（将来実装）
- **CDN**: 静的リソース配信最適化

## 開発・運用ルール

### コード品質
- **フォーマット**: Prettier + ESLint（フロント）/ PHP CS Fixer（バック）
- **型安全**: TypeScript strict mode / PHP strict_types
- **テスト**: 最低80%カバレッジ目標
- **レビュー**: プルリクエスト必須

### デプロイメント
- **CI/CD**: GitHub Actions
- **環境分離**: ステージング・本番環境分離
- **自動テスト**: デプロイ前必須実行
- **ロールバック**: 即座に復旧可能な構成

## バージョニング・アップデート方針

### アップデート戦略
- **Next.js**: 安定版リリース後2週間以内に検討
- **Laravel**: LTSバージョンを優先使用
- **セキュリティパッチ**: 即座適用
- **メジャーアップデート**: 十分な検証期間設定

### 互換性
- **ブラウザ対応**: モダンブラウザ（IE非対応）
- **Node.js**: 20.x系以上
- **PHP**: 8.3系以上
- **MySQL**: 8.0系以上

---

**最終更新日**: 2025年6月4日  
**次回見直し予定**: 2025年12月 