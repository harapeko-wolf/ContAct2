# 設定画面動的機能化タスクリスト

## 🎯 メインタスク: 設定画面の動的機能を実装する

### ✅ 完了項目
- [x] **1.1** 各設定項目の状態管理を個別に実装（現在すべてlocalStateのみ）
  - 設定データの型定義を追加
  - 各設定カテゴリごとの状態管理を実装
  - 未保存変更の検出機能を実装
  - 設定変更時のリアルタイム更新を実装
- [x] **1.2** 設定データをAPIから取得する機能を実装
  - フロントエンドでAPI呼び出しを実装
  - ローディング状態の管理を追加
  - エラーハンドリングを実装
- [x] **6.1** 設定取得API（GET /api/settings）を実装
  - AppSettingモデルとマイグレーションを作成
  - SettingsControllerを実装
  - デフォルト設定のSeederを作成
- [x] **6.2** 設定更新API（PUT /api/settings）を実装
  - バリデーション機能を実装
  - カテゴリ別の設定更新機能を実装
- [x] **2.3** リンク有効期限の動的バリデーション
  - リアルタイムバリデーション機能を実装
  - エラーメッセージの表示機能を追加
- [x] **7.4** フォームバリデーションメッセージの表示
  - 各入力フィールドにバリデーションエラー表示を実装
  - 視覚的なエラー状態の表示を追加
- [x] **3.5** アンケートのリアルタイムプレビュー機能
  - 2カラムレイアウトでプレビューパネルを実装
  - リアルタイムでアンケート画面をプレビュー表示
  - 設定変更時の即座の反映機能を実装
- [x] **5.1** パスワード変更のリアルタイムバリデーション
  - パスワード強度チェック機能を実装
  - 強度インジケーターの表示を追加
  - 確認パスワードの一致チェック機能を実装

### 🔲 実装待ちタスク

#### 1. データ管理・状態管理の改善
- [x] **1.1** 各設定項目の状態管理を個別に実装（現在すべてlocalStateのみ）
- [x] **1.2** 設定データをAPIから取得する機能を実装
- [x] **1.3** 設定変更時の差分検出機能を実装
- [x] **1.4** 未保存変更の警告機能を実装

#### 2. 一般設定タブの動的機能
- [x] **2.1** スイッチ切り替え時の即座のstate更新を実装
- [x] **2.2** 各スイッチの状態をAPIと同期
- [x] **2.3** リンク有効期限の動的バリデーション
- [ ] **2.4** 会社名変更時のリアルタイムプレビュー

#### 3. アンケート設定タブの動的機能
- [x] **3.1** 「選択肢を追加」ボタンの機能実装
- [x] **3.2** 選択肢の削除機能を実装
- [ ] **3.3** 選択肢の並び替え機能（ドラッグ&ドロップ）
- [x] **3.4** 「デフォルトに戻す」ボタンの機能実装
- [x] **3.5** アンケートのリアルタイムプレビュー機能

#### 4. スコアリング設定タブの動的機能
- [ ] **4.1** スコア計算のリアルタイムシミュレーション
- [x] **4.2** 時間レベルの動的追加・削除機能
- [ ] **4.3** スコアリングプリセットの保存・読み込み機能
- [ ] **4.4** スコア設定の妥当性チェック

#### 5. アカウント設定タブの動的機能
- [x] **5.1** パスワード変更のリアルタイムバリデーション
- [ ] **5.2** メールアドレス重複チェック機能
- [ ] **5.3** アカウント削除の確認ダイアログ
- [ ] **5.4** ログアウト機能の実装

#### 6. API連携・バックエンド対応
- [x] **6.1** 設定取得API（GET /api/settings）を実装
- [x] **6.2** 設定更新API（PUT /api/settings）を実装
- [ ] **6.3** APIエラーハンドリングの実装
- [ ] **6.4** 楽観的アップデートの実装

#### 7. UI/UX改善
- [x] **7.1** 保存状態のリアルタイム表示
- [ ] **7.2** 各タブの保存ボタンを個別化
- [x] **7.3** 変更検出時のビジュアルフィードバック
- [x] **7.4** フォームバリデーションメッセージの表示
- [ ] **7.5** ローディング状態の詳細化

#### 8. 高度な機能
- [ ] **8.1** 設定のインポート・エクスポート機能
- [ ] **8.2** 設定変更履歴の記録・表示
- [ ] **8.3** 複数ユーザー間での設定共有機能
- [ ] **8.4** テーマ・カラー設定の動的変更

## 📋 推奨実装順序
1. データ管理・状態管理の改善（1.1-1.4） ✅ **完了**
2. API連携・バックエンド対応（6.1-6.4） ✅ **基本完了**
3. 各タブの基本動的機能（2.1-2.4, 3.1-3.5, 4.1-4.4, 5.1-5.4） ← **次に実装**
4. UI/UX改善（7.1-7.5）
5. 高度な機能（8.1-8.4）

## 🎉 **重要な達成事項**
✅ **設定画面の基本動作が完全に動的に！**
- APIを通じたデータの取得・保存が実装済み
- リアルタイムの状態更新機能が動作
- 未保存変更の検出・警告が動作
- アンケート選択肢とスコアリング層の動的追加・削除が動作
- リアルタイムバリデーションとエラー表示が動作

## 🔧 技術要件
- React State Management（useState, useReducer）
- API通信（fetch, axios）
- フォームバリデーション
- TypeScript型定義
- エラーハンドリング
- ローディング状態管理

## ⚠️ 注意点
- すべての変更は保存確認後に適用
- APIエラー時の適切なフォールバック
- レスポンシブ対応の維持
- アクセシビリティの考慮 